This method takes ~6 minutes
